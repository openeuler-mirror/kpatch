From 96e3ca2fbed32589510c800e9efe31bab2f5e58a Mon Sep 17 00:00:00 2001
From: Zhipeng Xie <xiezhipeng1@huawei.com>
Date: Thu, 27 Feb 2020 15:36:55 -0500
Subject: [PATCH 17/17] create-diff-object: fix .orc_unwind_ip error

error: .orc_unwind_ip section header details
differ from .orc_unwind_ip

Don't correlate .orc_unwind sections and symbols

Signed-off-by: root <root@localhost.localdomain>
---
 kpatch-build/create-diff-object.c | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/kpatch-build/create-diff-object.c b/kpatch-build/create-diff-object.c
index c466eb0..320b239 100644
--- a/kpatch-build/create-diff-object.c
+++ b/kpatch-build/create-diff-object.c
@@ -967,6 +967,9 @@ static void kpatch_correlate_sections(struct list_head *seclist1, struct list_he
 					continue;
 			}
 
+			if (strstr(sec1->name, ".orc_unwind"))
+				continue;
+
 			kpatch_correlate_section(sec1, sec2);
 			break;
 		}
@@ -1012,6 +1015,9 @@ static void kpatch_correlate_symbols(struct list_head *symlist1, struct list_hea
 			    sym1->sec->twin != sym2->sec)
 				continue;
 
+			if (strstr(sym1->name, ".orc_unwind"))
+				continue;
+
 			kpatch_correlate_symbol(sym1, sym2);
 			break;
 		}
-- 
2.18.1

